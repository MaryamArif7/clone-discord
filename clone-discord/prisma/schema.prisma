generator client {
  provider = "prisma-client-js"
}
//5.3 prism setup: pasted the code from the planetscale 
datasource db {
  provider = "mysql"
  url = env("DATABASE_URL")
  relationMode = "prisma"
}
//5.4 prisma setup: creating models 
model Profile{
  id String @id @default(uuid())
  userId String @unique
  name String
  imageUrl String @db.Text
  email String @db.Text
  servers Server []
  members Member[]
  channels Channel[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
model Server {
  id String @id @default(uuid())
  name String
  imageUrl String @db.Text
  // 13.5 in 13.4 for the server function "where " wass giving the error so instead of db.text its @unique
  //after making chnaging in prisma schema run npx prism generate and npx prism db pusuh
  inviteCode String @unique
  profileId String

  profile Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)
  members Member[]
  channels Channel[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  @@index([profileId])
}
enum  MemberRole{
  ADMIN
  MODERATOR
  GUEST
}
model Member{
  id String @id @default(uuid())
  role MemberRole @default(GUEST)

  profileId String 
  profile Profile @relation(fields: [profileId],references: [id],onDelete: Cascade)
  serverId String
  server Server @relation(fields: [serverId],references: [id],onDelete: Cascade)
createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
@@index([profileId])
@@index([serverId])

}
enum ChannelType{
  TEXT 
  AUDIO
  VIDEO
}
model Channel {
  id String @id @default(uuid())
  name String
  type ChannelType @default(TEXT)
  profileId String
  serverId String

  profile Profile @relation(fields: [profileId], references: [id], onDelete: Cascade)
  server Server @relation(fields: [serverId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  @@index([serverId])
  @@index([profileId])
}
// after creating models we are rewuired to run some commands and needs to do this everytime we modlify the schema
// npx prisma genertae : this command will add the schema to the our node modules  so we can develop with it 
//npx prisma db push : this will add the all our collections to the  into our planetscale or whtever we are using for our mysqldb 